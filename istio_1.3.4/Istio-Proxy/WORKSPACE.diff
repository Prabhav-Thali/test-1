diff --git a/WORKSPACE b/WORKSPACE
index 636dea8..5479724 100644
--- a/WORKSPACE
+++ b/WORKSPACE
@@ -31,13 +31,19 @@ bind(
     name = "boringssl_crypto",
     actual = "//external:ssl",
 )
-
+local_repository(
+     name = "boringssl",
+     path = "$SOURCE_ROOT/boringssl",
+)
+bind(
+     name = "ssl",
+     actual = "@boringssl//:ssl",
+)
 # When updating envoy sha manually please update the sha in istio.deps file also
 #
 # Determine SHA256 `wget https://github.com/istio/envoy/archive/$COMMIT.tar.gz && sha256sum $COMMIT.tar.gz`
 # envoy commit date: 09/10/2019
 # bazel version: 0.28.1
-ENVOY_SHA = "d24427d43edfb1bd722aa781e22f87a11ec51e8d"
 
 ENVOY_SHA256 = "e3f7a59e696c8b9a1842d6a826adee5c265115ec1d21ae8f39c1434b0bd41241"
 
@@ -45,9 +51,7 @@ LOCAL_ENVOY_PROJECT = "/PATH/TO/ENVOY"
 
 http_archive(
     name = "envoy",
-    sha256 = ENVOY_SHA256,
-    strip_prefix = "envoy-" + ENVOY_SHA,
-    url = "https://github.com/istio/envoy/archive/" + ENVOY_SHA + ".tar.gz",
+    path = "$SOURCE_ROOT/envoy"
 )
 
 # TODO(silentdai) Use bazel args to select envoy between local or http
diff --git a/Makefile b/Makefile
index 620ccaa..0d33d84 100644
--- a/Makefile
+++ b/Makefile
@@ -39,7 +39,7 @@ endif
 
 UNAME := $(shell uname)
 ifeq ($(UNAME),Linux)
-BAZEL_CONFIG_DEV  = --config=libc++
+BAZEL_CONFIG_DEV  =
 BAZEL_CONFIG_REL  = --config=libc++ --config=release
 BAZEL_CONFIG_ASAN = --config=clang-asan --config=libc++
 BAZEL_CONFIG_TSAN = --config=clang-tsan --config=libc++
@@ -52,7 +52,7 @@ BAZEL_CONFIG_TSAN = # no working config
 endif
 
 build:
-	export PATH=$(PATH) CC=$(CC) CXX=$(CXX) && bazel $(BAZEL_STARTUP_ARGS) build $(BAZEL_BUILD_ARGS) $(BAZEL_CONFIG_DEV) $(BAZEL_TARGETS)
+	export PATH=$(PATH) CC=$(CC) CXX=$(CXX) && bazel $(BAZEL_STARTUP_ARGS) build -c opt $(BAZEL_BUILD_ARGS) $(BAZEL_CONFIG_DEV) $(BAZEL_TARGETS) --host_javabase=@local_jdk//:jdk --jobs=10
 
 build_envoy:
 	export PATH=$(PATH) CC=$(CC) CXX=$(CXX) && bazel $(BAZEL_STARTUP_ARGS) build $(BAZEL_BUILD_ARGS) $(BAZEL_CONFIG_REL) //src/envoy:envoy
diff --git a/WORKSPACE b/WORKSPACE
index 636dea8..d588fd9 100644
--- a/WORKSPACE
+++ b/WORKSPACE
@@ -31,23 +31,27 @@ bind(
     name = "boringssl_crypto",
     actual = "//external:ssl",
 )
-
+local_repository(
+     name = "boringssl",
+     path = "$SOURCE_ROOT/boringssl",
+)
+bind(
+     name = "ssl",
+     actual = "@boringssl//:ssl",
+)
 # When updating envoy sha manually please update the sha in istio.deps file also
 #
 # Determine SHA256 `wget https://github.com/istio/envoy/archive/$COMMIT.tar.gz && sha256sum $COMMIT.tar.gz`
 # envoy commit date: 09/10/2019
 # bazel version: 0.28.1
-ENVOY_SHA = "d24427d43edfb1bd722aa781e22f87a11ec51e8d"
 
 ENVOY_SHA256 = "e3f7a59e696c8b9a1842d6a826adee5c265115ec1d21ae8f39c1434b0bd41241"
 
 LOCAL_ENVOY_PROJECT = "/PATH/TO/ENVOY"
 
-http_archive(
+local_repository(
     name = "envoy",
-    sha256 = ENVOY_SHA256,
-    strip_prefix = "envoy-" + ENVOY_SHA,
-    url = "https://github.com/istio/envoy/archive/" + ENVOY_SHA + ".tar.gz",
+    path = "$SOURCE_ROOT/envoy"
 )
 
 # TODO(silentdai) Use bazel args to select envoy between local or http
diff --git a/extensions/stats/BUILD b/extensions/stats/BUILD
index a942cb3..19cad7a 100644
--- a/extensions/stats/BUILD
+++ b/extensions/stats/BUILD
@@ -54,14 +54,3 @@ proto_library(
     srcs = ["config.proto"],
 )
 
-envoy_cc_test(
-    name = "plugin_test",
-    size = "small",
-    srcs = ["plugin_test.cc"],
-    repository = "@envoy",
-    deps = [
-        ":stats_plugin",
-        "//external:abseil_hash_testing",
-        "@envoy//source/extensions/common/wasm:wasm_lib",
-    ],
-)
